{{- define "metrics-values" }}

{{- if .Values.metrics.istio.grafana.enabled }}
grafana:
  istio:
    {{- with .Values.metrics.istio.grafana }}
    {{- toYaml . | nindent 4 }}
    {{- end }}
{{- end }}
{{- if .Values.metrics.istio.prometheus.enabled }}
prometheus:
  istio:
    {{- with .Values.metrics.istio.prometheus }}
    {{- toYaml . | nindent 4 }}
    {{- end }}
{{- end }}
{{- if index .Values "metrics" "kube-prometheus-stack" }}
kube-prometheus-stack:
  {{- with index .Values "metrics" "kube-prometheus-stack" }}
  {{- toYaml . | nindent 2 }}
  {{- end }}
{{- end }}

{{- end }}


{{- define "metrics-argo" }}

  ignoreDifferences:
  - group: admissionregistration.k8s.io
    kind: ValidatingWebhookConfiguration
    jsonPointers:
    - /webhooks/0/failurePolicy
  - group: admissionregistration.k8s.io
    kind: MutatingWebhookConfiguration
    jsonPointers:
    - /webhooks/0/failurePolicy

{{- end }}


{{ include "kubezero-app.app" . }}
