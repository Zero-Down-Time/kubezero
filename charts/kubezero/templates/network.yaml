{{- define "network-values" }}

# since 1.23
cilium:
  enabled: true

  cluster:
    name: {{ .Values.global.clusterName }}
    {{- with .Values.network.cilium.cluster.id }}
    id: {{ . }}
  ipam:
    operator:
      clusterPoolIPv4PodCIDRList:
        - 10.{{ . }}.0.0/16
    {{- end }}

  prometheus:
    enabled: {{ .Values.metrics.enabled }}

{{- with index .Values "network" "metallb" }}
metallb:
  {{- toYaml . | nindent 2 }}
{{- end }}

{{- end }}


{{- define "network-argo" }}
  # Metallb
  ignoreDifferences:
  - group: apiextensions.k8s.io
    kind: CustomResourceDefinition
    jsonPointers:
    - /spec/conversion/webhook/clientConfig/caBundle
{{- end }}

{{ include "kubezero-app.app" . }}
